#!/usr/bin/env perl

my $log; { undef $/; $log = <>; };

$log =~ s{^[^\n]{1,5}\n}{}gm;

$log =~ s{^. History\n}{}gm;

$log =~ s{^(\d{1,2})[-.:]?(\d{2} [AP]M)$}{\1:\2\t}gm;

$log =~ s{\n[ \t]*(\S+)[ \.](com|org|net|gg|edu)$}{\t\1.\2}gm;

$log =~ s{^
	(?<at>\d{1,2}:\d{2}\ [AP]M\t)\n
    (?<bt>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<ct>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<dt>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<et>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<ft>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<gt>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<ht>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<it>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<jt>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<kt>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<lt>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<mt>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<nt>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<ot>\d{1,2}:\d{2}\ [AP]M\t)\n
 (?:(?<pt>\d{1,2}:\d{2}\ [AP]M\t)\n
    )?)?)?)?)?)?)?)?)?)?)?)?)?)?
	(?!\d{1,2}:\d\d\ [AP]M)(?<an>[^\n]+\n)
	(?!\d{1,2}:\d\d\ [AP]M)(?<bn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<cn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<dn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<en>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<fn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<gn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<hn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<in>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<jn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<kn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<ln>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<mn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<nn>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<on>[^\n]+\n)
 (?:(?!\d{1,2}:\d\d\ [AP]M)(?<pn>[^\n]+\n)
 	)?)?)?)?)?)?)?)?)?)?)?)?)?)?
 }{$+{at}$+{an}$+{bt}$+{bn}$+{ct}$+{cn}$+{dt}$+{dn}$+{et}$+{en}$+{ft}$+{fn}$+{gt}$+{gn}$+{ht}$+{hn}$+{it}$+{in}$+{jt}$+{jn}$+{kt}$+{kn}$+{lt}$+{ln}$+{mt}$+{mn}$+{nt}$+{nn}$+{ot}$+{on}$+{pt}$+{pn}}gmx;

$log =~ s{^(\d{1,2}:\d{2}\ [AP]M\t)\n}{\1}gm;

$log =~ s{^([^\n\t]+)\t([^\n]+)[ \t](\S+)[ \.](com|org|net|gg|edu)}{\1\t\3.\4\t\2}gm;

print "\%\%\n$log\n\%\%\%\n";